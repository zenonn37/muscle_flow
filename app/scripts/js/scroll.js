/**
 * Created by pure coder on 4/12/2014.
 */

angular.module("smoothScroll",[]).directive("smoothScroll",["$timeout","smoothScroll",function($timeout,smoothScroll){return{restrict:"A",link:function($scope,$elem,$attrs){$timeout(function(){if(typeof $attrs.scrollIf==="undefined"||$attrs.scrollIf==="true"){smoothScroll($elem[0],{duration:$attrs.duration,offset:$attrs.offset,easing:$attrs.easing})}})}}}]).directive("scrollTo",["smoothScroll",function(smoothScroll){return{restrict:"A",link:function($scope,$elem,$attrs){var targetElement;$elem.on("click",function(e){targetElement=document.getElementById($attrs.scrollTo);if(targetElement){e.preventDefault();smoothScroll(targetElement,{duration:$attrs.duration,offset:$attrs.offset,easing:$attrs.easing});return false}})}}}]).factory("smoothScroll",["$timeout",function($timeout){var getScrollLocation=function(){return window.pageYOffset?window.pageYOffset:document.documentElement.scrollTop};var smoothScroll=function(element,options){$timeout(function(){var startLocation=getScrollLocation(),timeLapsed=0,percentage,position;options=options||{};var duration=options.duration||800,offset=options.offset||0,easing=options.easing||"easeInOutQuart";var easingPattern=function(type,time){if(type=="easeInQuad")return time*time;if(type=="easeOutQuad")return time*(2-time);if(type=="easeInOutQuad")return time<.5?2*time*time:-1+(4-2*time)*time;if(type=="easeInCubic")return time*time*time;if(type=="easeOutCubic")return--time*time*time+1;if(type=="easeInOutCubic")return time<.5?4*time*time*time:(time-1)*(2*time-2)*(2*time-2)+1;if(type=="easeInQuart")return time*time*time*time;if(type=="easeOutQuart")return 1- --time*time*time*time;if(type=="easeInOutQuart")return time<.5?8*time*time*time*time:1-8*--time*time*time*time;if(type=="easeInQuint")return time*time*time*time*time;if(type=="easeOutQuint")return 1+--time*time*time*time*time;if(type=="easeInOutQuint")return time<.5?16*time*time*time*time*time:1+16*--time*time*time*time*time;return time};var getEndLocation=function(element){var location=0;if(element.offsetParent){do{location+=element.offsetTop;element=element.offsetParent}while(element)}location=Math.max(location-offset,0);return location};var endLocation=getEndLocation(element);var distance=endLocation-startLocation;var stopAnimation=function(){var currentLocation=getScrollLocation();if(position==endLocation||currentLocation==endLocation||window.innerHeight+currentLocation>=document.body.scrollHeight){clearInterval(runAnimation)}};var animateScroll=function(){timeLapsed+=16;percentage=timeLapsed/duration;percentage=percentage>1?1:percentage;position=startLocation+distance*easingPattern(easing,percentage);window.scrollTo(0,position);stopAnimation()};var runAnimation=setInterval(animateScroll,16)})};return smoothScroll}]);
